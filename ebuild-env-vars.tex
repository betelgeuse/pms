\section{Defined Variables}
\label{ebuild-env-vars}

\subsection{Globally Defined Variables}
\label{global-ebuild-vars}

The following variables are available, read-only, in all phases of the ebuild environment. They
must not be modified by ebuild code.
\begin{description}
\item[P] Package name and version, without the revision part. For example, \t{vim-7.0.174}.
\item[PN] Package name, for example \t{vim}.
\item[PV] Package version, for example \t{7.0.174}.
\item[PR] Package revision, or \t{r0} if none exists.
\item[PVR] Package version and revision, for example \t{7.0.174-r0} or \t{7.0.174-r1}.
\item[PF] Package name, version, and revision, for example \t{vim-7.0.174-r1}.
\item[A] All source files available for the package. Does not include any that are disabled because
    of USE conditionals. The value is calculated from the base names of each element of the
    \t{SRC\_URI} ebuild metadata variable.
\item[AA] All source files that could be available for the package, including any that are disabled
    in \t{A} because of USE conditionals. The value is calculated from the base names of each element
    of the \t{SRC\_URI} ebuild metadata variable.
\item[CATEGORY] The package's category, for example \t{app-editors}.
\item[FILESDIR] The full path to the package's files directory, used for small support files or
    patches. See section \ref{package-dirs}. May or may not exist; if a repository provides no
    support files for the package in question then an ebuild must be prepared for the situation
    where \t{FILESDIR} points to a non-existent directory.
\item[WORKDIR] The full path to the ebuild's working directory, in which all build data should be
    contained. \label{env-var-WORKDIR}
\item[T] The full path to a temporary directory for use by the ebuild.
\item[USE] A whitespace-delimited list of all active USE flags for this ebuild, including those
    originating from variables in \t{USE\_EXPAND}.
\item[] All variables set in the active profiles' \t{make.defaults} files will be exported to the
    ebuild environment.
\item[HOME] The full path to an appropriate temporary directory for use by any programs invoked by
    the ebuild that may read or modify the home directory.
\item[PATH] Must be initialized by the package manager to a ``usable'' default.  The exact value here
    is left up to interpretation, but it should include the equivalent ``sbin'' and ``bin'' and any
    package manager specific directories.
\item[CHOST,CBUILD,CTARGET] If not set by profiles, must contain either an appropriate
    machine tuple (the definition of appropriate is beyond the scope of this specification) or
    be unset.
\item[EBUILD\_PHASE] Takes one of the values \t{setup}, \t{nofetch}, \t{unpack}, \t{compile},
    \t{test}, \t{install}, \t{preinst}, \t{postinst}, \t{prerm}, \t{postrm} according to the ebuild
    function currently being executed.
\item[TMPDIR] Must be set to the location of a usable temporary directory, for any applications
    called by an ebuild. Should not be used by ebuilds directly; see \t{T} above.
\item[GZIP,BZIP,BZIP2,CDPATH,GREP\_OPTIONS,GREP\_COLOR,GLOBIGNORE] must not be set.
\end{description}

\TODOBUG{170163}{Do we require specific ordering for A and AA? Some ebuilds rely
upon it. Should they be allowed to? What about exact whitespace? Do we mandate exactly one space
separation and no leading or trailing space?}

\subsection{Phase-specific variables}

In addition to the global list in section \ref{global-ebuild-vars}, there are several extra
variables available in specific ebuild phases.

\subsubsection{src\_install}
\begin{description}
\item[D] Contains the full path to the image directory into which the package should be installed.
\item[INSDESTTREE] Controls the location where doins installs things.
\end{description}

\subsubsection{pkg\_preinst}
\begin{description}
\item[D] Contains the full path to the image directory of the package about to be merged.
\end{description}

\subsubsection{pkg\_*}
\begin{description}
\item[ROOT] The absolute path to the root directory into which the package is to be merged. \t{ROOT}
    is only guaranteed to be available in \t{pkg\_setup}, \t{pkg\_preinst}, \t{pkg\_postinst},
    \t{pkg\_prerm} and \t{pkg\_postrm}. Other phases should not make use of it, as any binary
    package generated should not depend on the value of \t{ROOT}. Those phases which run with full
    filesystem access should not touch any files outside of the directory given in \t{ROOT}. Also of
    note is that in a cross-compiling environment, binaries inside of \t{ROOT} will not be
    executable on the build machine, so ebuilds should not call them. If \t{ROOT} is empty, ebuilds
    must behave as if \t{ROOT} were equal to \t{/}.
\end{description}

% vim: set filetype=tex fileencoding=utf8 et tw=100 spell spelllang=en :
